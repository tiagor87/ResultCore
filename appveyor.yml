version: 0.0.{build}
pull_requests:
  do_not_increment_build_number: true
image: Visual Studio 2017
skip_tags: true
dotnet_csproj:
  patch: true
  file: '**\*.csproj'
  version: '{version}'
  package_version: '{version}'
environment:
  configuration: Release
  COVERALLS_REPO_TOKEN:
    secure: PgqGX/MKkBHptwqnLx5PvnPxIBQ/zRryi/1q/WrQ5RYmFv/7rWrWfQybg17g4FaK
build_script:
  - ps: dotnet build -c Release
test_script:
  - ps: >-
      nuget install xunit.runner.console -OutputDirectory packages -Version 2.4.1

      nuget install OpenCover -OutputDirectory packages -Version 4.7.922

      dotnet tool install coveralls.net --tool-path packages

      .\packages\OpenCover.4.7.922\tools\OpenCover.Console.exe -register:user -target:dotnet.exe "-targetargs:"".\packages\xunit.runner.console.2.4.1\tools\netcoreapp2.0\xunit.console.dll"" "".\tests\UnitTests\bin\Release\netcoreapp2.0\ResultCore.UnitTests.dll"" -noshadow -appveyor" -filter:"+[ResultCore*]*" -oldStyle -output:coverage.xml

      .\packages\csmacnz.coveralls.exe --opencover -i coverage.xml --repoToken $env:COVERALLS_REPO_TOKEN --commitId $env:APPVEYOR_REPO_COMMIT --commitBranch $env:APPVEYOR_REPO_BRANCH --commitAuthor $env:APPVEYOR_REPO_COMMIT_AUTHOR --commitEmail $env:APPVEYOR_REPO_COMMIT_AUTHOR_EMAIL --commitMessage $env:APPVEYOR_REPO_COMMIT_MESSAGE --jobId $env:APPVEYOR_JOB_ID

